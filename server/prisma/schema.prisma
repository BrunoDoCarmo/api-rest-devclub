generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model Tenant {
  id        String           @id @default(uuid())
  type      Type_Responsible
  name      String //NOME
  size      Size             @default(SMALL) //TAMANHO
  createdAt DateTime         @default(now()) //DATA CRIACAO
  updatedAt DateTime         @updatedAt //DATA ALTERACAO

  responsible Responsible? //RESPONSAVEL
  user        User[] //USUARIO

  @@map("tenant")
}

model Responsible {
  id           String   @id @default(uuid())
  name         String //NOME
  cpf          String?  @unique
  cnpj         String?  @unique
  public_place String //LOGRADOURO
  number       String //NUMERO
  neighborhood String //BAIRRO
  complement   String? //COMPLEMENTO
  cep          String
  city         String //CIDADE
  uf           String
  telephone1   String? //TELEFONE1
  telephone2   String? //TELEFONE2
  cell_phone1  String //CELULAR1
  cell_phone2  String? //CELULAR2
  email        String @unique
  state        State    @default(ACTIVE) //ESTADO
  createdAt    DateTime @default(now()) //DATA CRIACAO
  updatedAt    DateTime @updatedAt //DATA ALTERACAO

  tenant   Tenant @relation(fields: [tenantId], references: [id])
  tenantId String @unique

  companies_data Company_Data[]
  customers      Customer[]
  users          User[]

  @@map("responsible")
}

model User {
  id        String   @id @default(uuid())
  name      String //NOME
  email     String   @unique
  username  String   @unique //NOME DE USUARIO
  password  String //SENHA
  role      UserRole @default(USER)
  state     State    @default(ACTIVE) //ESTADO
  createdAt DateTime @default(now()) //DATA CRIACAO
  updatedAt DateTime @updatedAt //DATA ALTERACAO

  tenant   Tenant @relation(fields: [tenantId], references: [id])
  tenantId String

  responsible   Responsible @relation(fields: [responsibleId], references: [id])
  responsibleId String

  emailVerified      Boolean             @default(false)
  emailVerifications EmailVerification[]

  @@map("user")
}

model EmailVerification {
  id        String                @id @default(uuid())
  email     String @unique
  tokenHash String
  type      EmailVerificationType
  expiresAt DateTime
  verified  Boolean               @default(false)

  userId String?

  user User? @relation(fields: [userId], references: [id])

  createdAt DateTime @default(now())

  @@map("emailverification")
}

model Company_Data {
  id           String   @id @default(uuid())
  company_name String //RAZAO SOCIAL
  fantasy      String //FANTASIA
  cnpj         String   @unique
  ie           String?
  public_place String //LOGRADOURO
  number       String //NUMERO
  neighborhood String //BAIRRO
  complement   String? //COMPLEMENTO
  cep          String
  city         String //CIDADE
  uf           String
  telephone1   String? //TELEFONE1
  telephone2   String? //TELEFONE2
  cell_phone1  String //CELULAR1
  cell_phone2  String? //CELULAR2
  email        String
  site         String?
  state        State    @default(ACTIVE) //ESTADO
  createdAt    DateTime @default(now()) //DATA CRIACAO
  updatedAt    DateTime @updatedAt //DATA ALTERACAO

  responsible   Responsible @relation(fields: [responsibleId], references: [id])
  responsibleId String

  @@map("company_data")
}

model Customer {
  id           String   @id @default(uuid())
  name         String //NOME
  cpf          String?  @unique
  cnpj         String?  @unique
  ie           String?
  regime       Regime   @default(ICMS_TAXPAYER)
  public_place String //LOGRADOURO
  number       String //NUMERO
  neighborhood String //BAIRRO
  complement   String? //COMPLEMENTO
  cep          String
  city         String //CIDADE
  uf           String
  telephone1   String? //TELEFONE1
  telephone2   String? //TELEFONE2
  cell_phone1  String //CELULAR1
  cell_phone2  String? //CELULAR2
  email        String
  contact      String? //CONTATO
  state        State    @default(ACTIVE) //ESTADO
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  responsible   Responsible @relation(fields: [responsibleId], references: [id])
  responsibleId String

  @@map("customer")
}

enum Type_Responsible {
  PHYSICAL //FISICA
  LEGAL //JURIDICA
}

enum Size {
  SMALL //PEQUENO
  MEDIUM //MEDIO
  LARGE //GRANDE
}

enum UserRole {
  ADMIN
  USER
}

enum EmailVerificationType {
  USER
}

enum State {
  ACTIVE //ATIVO
  DISABLED //DESATIVADO
  DELETED //DELETADO
}

enum Regime {
  ICMS_TAXPAYER //CONTRIBUINTE DE ICMS
  EXEMPT_FROM_REGISTRATION //ISENTO DE INSCRICAO
  NON_TAXPAYER //NAO CONTRIBUINTE
}
